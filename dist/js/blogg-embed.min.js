!function(e,t,n){"use strict";t.options.flash.swf="http://static.blogg.no/video/vendors/video.js/video-js.swf";var r=function(r){var i=JSON.parse("false"),o=[],a={type:r,id:0,settings:{},player:null,src:"",playsCounter:0,index:-1},s={watermark:{url:"http://blogg.no",image:"http://static.blogg.no/blogs/image/NA_negativ_small.png",fadeTime:1e3},wavesurfer:{msDisplayMax:10,debug:i,waveColor:"grey",progressColor:"#0092f5",cursorColor:"white",hideScrollbar:!0}},l=function(t,n,r){return i?0:void e.getJSON("http://blogsoft.local/index.bd?fa=public.updateMediaInfo&callback=?",{blogId:t,mediaId:n,mediaType:r}).done(function(e){console.log(e)})},c=function(t){var n={};return e.each(t.split("&"),function(e,t){var r=t.split("=");2==r.length&&(n[r[0].toString()]=r[1].toString())}),n},p=function(){if(i){var e=c(document.location.search.substr(1));return"video"==a.type?e.v:e.id}var t=location.pathname.split("/");return t[t.length-1]},d=function(){o=[],o.push(n.location.href),a.index=0,a.id=p()},u=function(){var e={controls:!0,autoplay:!1,loop:!1,preload:"none",controlBar:{fullscreenToggle:!0}};switch(a.type){case"audio":e.height=100,e.controlBar.fullscreenToggle=!1}return e},f=function(n,r,i){var o=t(n,r,i);return o.on("play",e.proxy(g,this)),o.on("ended",e.proxy(y,this)),o},h=function(e){e[0].pause();var t=null,n=e.find("source");return n.length&&(t=n.attr("src"),n.remove()),e[0].load(),t},v=function(t,n){if(!t||!e("#"+t).length)return console.log("Not found"),this;d();var r=u(),o=h(e("#"+t));a.settings=e.extend({},r,n);var l=function(){switch(a.type){case"video":i&&a.id?(this.src([{type:"video/mp4",src:"resources/videos/"+a.id+".mp4"}]),this.poster("resources/videos/posters/"+a.id+".jpg")):o&&this.src([{type:"video/mp4",src:o}]),this.watermark(s.watermark);break;case"audio":i&&a.id?(s.wavesurfer.src="resources/audios/"+a.id+".mp3",this.wavesurfer(s.wavesurfer)):o&&(s.wavesurfer.src=o,this.wavesurfer(s.wavesurfer))}};return a.player=f(t,a.settings,l),a.playsCounter=0,this},g=function(e){a.playsCounter++,1===a.playsCounter&&l("",a.id,a.type)},y=function(){var e=1500,t=o[a.index+1];t&&setTimeout(function(){n.location.href=t},e)},m=function(t){var r=[];return t.each(function(t){var i=c(this.href.split("?")[1]),o=e(this).parent();i&&(r[t]=this.href,n.location.href.indexOf(this.href)>-1&&(o.addClass("currently-playing"),a.index=t,t>0&&a.player.autoplay(!0),o.parent().animate({scrollTop:t*o.outerHeight()+1},500)))}),r},w=function(){var t=e(".media-playlist__header__info span");t.text(a.index+1+"/"+o.length)},b=function(){var t=e("<a>",{title:"Open",href:"#",class:"media-playlist__icon",click:function(t){return t.stopPropagation(),e(".media-playlist").toggleClass("open"),!1}}),n=t.clone(!0,!0);t.html('<span class="vjs-icon-chapters"></span>').wrap('<div class="drawer-handle text-nowrap"></div>').parent().append('<span class="media-playlist__header__info"><span></span> videos</span>').prependTo(".media-playlist"),n.attr("title","Close").html("&times;").wrap('<div class="pull-right text-center text-muted"></div>').parent().prependTo(".media-playlist__header"),e(".media-playlist").on("click",function(e){e.stopPropagation()}),t.on("click",function(){e("body").on("click",function(){e(".drawer").toggleClass("open"),e(this).off("click")})}),n.on("click",function(){e("body").off("click")})},x=function(t){if(a.player){var n=e(t);n.length>0&&(o=m(n),"video"==a.type&&b(),w())}};return{createPlayer:f,setMediaPlayer:v,setPlayList:x}};n.embedMedia=r||{}}(jQuery,videojs,window);