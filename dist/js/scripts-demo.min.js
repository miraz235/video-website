!function(e,t){"use strict";t.options.flash.swf="../vendors/video.js/video-js.swf";var o=JSON.parse("true"),i=function(t){var o={};return e.each(t.split("&"),function(e,t){var i=t.split("=");2==i.length&&(o[i[0].toString()]=i[1].toString())}),o},a={watermark:{url:"http://blogg.no",image:"resources/img/NA_negativ_small.png",fadeTime:1e3},wavesurfer:{src:null,msDisplayMax:10,debug:!0,waveColor:"grey",progressColor:"#0092f5",cursorColor:"white",hideScrollbar:!1}},s={init:function(t){t&&e("#"+t).length&&(this.vPlayerId=t,this.setVideoPlayer())},setVideoPlayer:function(){var o=this,i=t(o.vPlayerId,{controls:!0,autoplay:!0,preload:"auto"});o.playsCounter=0,i.watermark(a.watermark),i.on("play",e.proxy(o.setVideoPlayEvent,o))},setVideoPlayEvent:function(t){this.playsCounter++,console.log("Plays "+this.playsCounter),1===this.playsCounter&&e.post("http://blogsoft.local/index.bd?fa=public.updateMediaInfo",{blogId:"",mediaId:"",mediaType:"video"}).done(function(e){console.log(e)})}},n={init:function(t){t&&e("#"+t).length&&(this.vPlayerId=t,this.currentIndex=-1,this.videoList=[],this.setVideoList(),this.setMediaId(),this.setVideoNumber(),this.setAutoChange(),this.setVideoPlayer())},setMediaId:function(){var e=i(document.location.search.substr(1));this.mediaId=e.v,!this.mediaId&&this.videoList[0]&&window.location.replace(this.videoList[0])},setVideoList:function(){var t=this,o=e(".media-playlist__tracks li .media-playlist__video");o.each(function(o){var a=i(this.href.split("?")[1]),s=e(this).parent();if(a){a.v;t.videoList[o]=this.href,window.location.href.indexOf(this.href)>-1&&(s.addClass("currently-playing"),t.currentIndex=o,s.parent().animate({scrollTop:o*s.outerHeight()+1},500))}})},setVideoNumber:function(){var t=e(".media-playlist__header__info span");t.text(this.currentIndex+1+"/"+this.videoList.length)},setAutoChangePlayList:function(e){void 0!==typeof localStorage?localStorage.setItem("autoplayPlaylist",e):console.log("Sorry! No Web Storage support..")},getAutoChangePlayList:function(){if(void 0!==typeof localStorage&&void 0!==localStorage.autoplayPlaylist){var t=JSON.parse(localStorage.autoplayPlaylist);return e("#mediaAutoplay").prop("checked",t),t}return console.log("Sorry! No Web Storage support.."),e("#mediaAutoplay").is(":checked")},setAutoChange:function(){var t=this,o=t.getAutoChangePlayList();t.setAutoChangePlayList(o),e("#mediaAutoplay").change(function(o){t.setAutoChangePlayList(e(this).is(":checked"))})},setVideoPlayer:function(){var i=this,s=t(i.vPlayerId,{controls:!0,autoplay:!0,preload:"none"},function(){o&&i.mediaId&&(this.src([{type:"video/mp4",src:"resources/videos/"+i.mediaId+".mp4"}]),this.poster("resources/videos/posters/"+i.mediaId+".jpg"))});i.playsCounter=0,s.watermark(a.watermark),s.on("play",e.proxy(i.setVideoPlayEvent,i)),s.on("ended",e.proxy(i.setVideoEndEvent,i))},setVideoPlayEvent:function(t){var o=this;o.playsCounter++,console.log("Plays "+o.playsCounter),1===o.playsCounter&&e.post("http://blogsoft.local/index.bd?fa=public.updateMediaInfo",{blogId:"",mediaId:o.mediaId,mediaType:"video"}).done(function(e){console.log(e)})},setVideoEndEvent:function(e){var t=this.videoList[this.currentIndex+1];t&&this.getAutoChangePlayList()&&setTimeout(function(){window.location.href=t+"#content"},1500)}},r={init:function(){var o=e("audio.js-media-audio"),i=this,s={controls:!0,autoplay:!1,loop:!1,height:100,plugins:{wavesurfer:a.wavesurfer}};i.audios=[],o.each(function(o){this.pause();var a=null,n=e(this).find("source");n.length&&(a=n.attr("src"),n.remove()),this.load(),s.plugins.wavesurfer.src=a,i.playsCounter=0,i.audios[o]=t(this,s),i.audios[o].on("play",function(t){for(var o=0;o<i.audios.length;o++)if(i.audios[o].id()!=t.target.id){var a=!i.audios[o].paused();a&&(i.audios[o].pause(),i.audios[o].currentTime(0),i.playsCounter=0)}if(i.playsCounter++,1===i.playsCounter){var s=e(this.el()).attr("data-audio-id");s&&(e.post("http://blogsoft.local/index.bd?fa=public.updateMediaInfo",{blogId:"",mediaId:s,mediaType:"audio"}).done(function(e){console.log(e)}),e(this.el()).attr("data-audio-id",""))}})})}};e(document).ready(function(){s.init("videoSingle"),n.init("videoMediaPlayer"),r.init()})}(jQuery,videojs);