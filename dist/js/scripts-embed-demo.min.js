!function(e,t){"use strict";t.options.flash.swf="../vendors/video.js/video-js.swf";var i=JSON.parse("true"),a=function(t,a){return i?0:void e.getJSON("http://blogsoft.local/index.bd?fa=public.updateMediaInfo&callback=?",{blogId:t,mediaId:a,mediaType:"video"}).done(function(e){console.log(e)})},s=function(t){var i={};return e.each(t.split("&"),function(e,t){var a=t.split("=");2==a.length&&(i[a[0].toString()]=a[1].toString())}),i},o={watermark:{url:"http://blogg.no",image:"resources/img/NA_negativ_small.png",fadeTime:1e3},wavesurfer:{msDisplayMax:10,debug:!0,waveColor:"grey",progressColor:"#0092f5",cursorColor:"white",hideScrollbar:!1}},n=function(){var e=location.pathname.split("/");return e[e.length-1]},r={init:function(t){t&&e("#"+t).length&&(this.vPlayerId=t,this.setMediaId(),this.setVideoPlayer())},setMediaId:function(){this.mediaId=n()},setVideoPlayer:function(){var i=this,a={controls:!0,preload:"auto"};i.playsCounter=0,i.vplayer=t(i.vPlayerId,a),i.vplayer.watermark(o.watermark),i.vplayer.on("play",e.proxy(i.setVideoPlayEvent,i))},setVideoPlayEvent:function(e){this.playsCounter++,console.log("Plays "+this.playsCounter),a("",this.mediaId)}},l={init:function(t){t&&e("#"+t).length&&(this.vPlayerId=t,this.currentIndex=-1,this.videoList=[],this.setVideoList(),this.setMediaId(),this.setVideoNumber(),this.setVideoPlayer())},setMediaId:function(){if(i){var e=s(document.location.search.substr(1));this.mediaId=e.v,!this.mediaId&&this.videoList[0]&&window.location.replace(this.videoList[0])}else this.mediaId=n()},setPlaylistDrawer:function(){var t=e("<a>",{title:"Open",href:"#",class:"media-playlist__icon",click:function(t){return t.stopPropagation(),e(".media-playlist").toggleClass("open"),!1}}),i=t.clone(!0,!0);t.html('<span class="vjs-icon-chapters"></span>').wrap('<div class="playlist-drawyer text-nowrap"></div>').parent().append('<span class="media-playlist__header__info"><span></span> videos</span>').prependTo(".media-playlist"),i.attr("title","Close").html("&times;").wrap('<div class="pull-right text-center text-muted"></div>').parent().prependTo(".media-playlist__header"),e(".media-playlist").on("click",function(e){e.stopPropagation()}),t.on("click",function(){e("body").on("click",function(){e(".media-playlist").toggleClass("open"),e(this).off("click")})}),i.on("click",function(){e("body").off("click")})},setVideoList:function(){var t=this,i=e(".media-playlist__tracks li .media-playlist__video");i.each(function(i){var a=s(this.href.split("?")[1]),o=e(this).parent();if(a){a.v;t.videoList[i]=this.href,window.location.href.indexOf(this.href)>-1&&(o.addClass("currently-playing"),t.currentIndex=i,o.parent().animate({scrollTop:i*o.outerHeight()+1},500))}}),t.setPlaylistDrawer()},setVideoNumber:function(){var t=e(".media-playlist__header__info span");t.text(this.currentIndex+1+"/"+this.videoList.length)},setVideoPlayer:function(){var a=this,s=!1;a.currentIndex>0&&(s=!0),a.vplayer=t(a.vPlayerId,{controls:!0,autoplay:s,preload:"none"},function(){i&&a.mediaId&&(this.src([{type:"video/mp4",src:"resources/videos/"+a.mediaId+".mp4"}]),this.poster("resources/videos/posters/"+a.mediaId+".jpg"))}),a.vplayer.watermark(o.watermark),a.playsCounter=0,a.vplayer.on("ended",e.proxy(a.setVideoEndEvent,a)),a.vplayer.on("play",e.proxy(a.setVideoPlayEvent,a))},setVideoPlayEvent:function(e){this.playsCounter++,console.log("Plays "+this.playsCounter),a("",this.mediaId)},setVideoEndEvent:function(e){var t=this.videoList[this.currentIndex+1];t&&setTimeout(function(){window.location.href=t},1500)}},d={init:function(t){t&&e("#"+t).length&&(this.aPlayerId=t,this.setMediaId(),this.setAudioPlayer())},setMediaId:function(){var e=s(document.location.search.substr(1));this.mediaId=e.id},getSource:function(){var t=e("#"+this.aPlayerId);t[0].pause();var i=null,a=t.find("source");return a.length&&(i=a.attr("src"),a.remove()),t[0].load(),i},setAudioPlayer:function(){var i=this,a={controls:!0,autoplay:!1,loop:!1,height:100,plugins:{wavesurfer:o.wavesurfer}};a.plugins.wavesurfer.src=i.getSource(),i.playsCounter=0;var s=t(i.aPlayerId,a);s.on("play",e.proxy(i.setAudioPlayEvent,i))},setAudioPlayEvent:function(e){this.playsCounter++,console.log("Plays "+this.playsCounter),1===this.playsCounter&&a("",this.mediaId,"audio")}};e(function(){r.init("videoSingle"),l.init("videoMediaPlayer"),d.init("audioSingle")})}(jQuery,videojs);